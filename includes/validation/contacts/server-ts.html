

<h4 id="requires-auth-partial.html">_requires-auth-partial.html<a class="header-anchor" href="javascript:;" onclick="location.hash='#requires-auth-partial.html'" aria-label="Permalink"> </a></h4>
<pre><code class="language-html">{{ `/server-ts/login?continue=${PathInfo}`
   | redirectIfNotAuthenticated }}

&lt;div style=&quot;text-align:right&quot;&gt;
    &lt;small class=&quot;text-muted&quot;&gt;
        {{ userSession.DisplayName }} 
        | &lt;a href=&quot;/auth/logout?continue=/server/&quot;&gt;Sign Out&lt;/a&gt;
    &lt;/small&gt;
&lt;/div&gt;
</code></pre>
<h4 id="dtos.ts">dtos.ts<a class="header-anchor" href="javascript:;" onclick="location.hash='#dtos.ts'" aria-label="Permalink"> </a></h4>
<pre><code class="language-ts">// generated with /typescript-add-servicestack-reference

export class Contact
{
    public constructor(init?:Partial&lt;Contact&gt;) { (&lt;any&gt;Object).assign(this, init); }
    public id: number;
    public userAuthId: number;
    public title: Title;
    public name: string;
    public color: string;
    public filmGenres: FilmGenres[];
    public age: number;
}

// @Route(&quot;/contacts/{Id}&quot;, &quot;DELETE&quot;)
// @Route(&quot;/contacts/{Id}/delete&quot;, &quot;POST&quot;)
export class DeleteContact implements IReturnVoid
{
    public constructor(init?:Partial&lt;DeleteContact&gt;) { (&lt;any&gt;Object).assign(this, init); }
    public id: number;
    public continue: string;
    public createResponse() {}
    public getTypeName() { return 'DeleteContact'; }
}

// @Route(&quot;/contacts&quot;, &quot;GET&quot;)
export class GetContacts implements IReturn&lt;GetContactsResponse&gt;
{
    public constructor(init?:Partial&lt;GetContacts&gt;) { (&lt;any&gt;Object).assign(this, init); }
    public createResponse() { return new GetContactsResponse(); }
    public getTypeName() { return 'GetContacts'; }
}
</code></pre>
<h4 id="index.html">index.html<a class="header-anchor" href="javascript:;" onclick="location.hash='#index.html'" aria-label="Permalink"> </a></h4>
<pre><code class="language-html">{{ 'requires-auth' | partial }}

{{ '/server-ts/contacts/' | assignTo: continue }}

&lt;h3&gt;Add new Contact&lt;/h3&gt;

&lt;form action=&quot;/contacts&quot; method=&quot;post&quot; class=&quot;col-lg-4&quot;&gt;
    
    &lt;div class=&quot;form-group&quot;&gt;
        {{ '&lt;div class=&quot;alert alert-danger&quot;&gt;{0}&lt;/div&gt;' | htmlFormat(errorResponseExcept('title,name,color,filmGenres,age,agree')) }}
        &lt;input type=&quot;hidden&quot; name=&quot;Continue&quot; value=&quot;{{ continue }}&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;ErrorView&quot; value=&quot;{{ continue }}&quot;&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-group&quot;&gt;
        &lt;div class=&quot;form-check&quot; data-invalid=&quot;{{ 'title' | errorResponse }}&quot;&gt;
            {{#each contactTitles}}
            &lt;div class=&quot;custom-control custom-radio custom-control-inline&quot;&gt;
                &lt;input type=&quot;radio&quot; id=&quot;title-{{Key}}&quot; name=&quot;title&quot; value=&quot;{{Key}}&quot; class=&quot;custom-control-input&quot;
                       {{ {checked:formValue('title')==Key} | htmlAttrs }}&gt;
                &lt;label class=&quot;custom-control-label&quot; for=&quot;title-{{Key}}&quot;&gt;{{Value}}&lt;/label&gt;
            &lt;/div&gt;
            {{/each}}
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;name&quot;&gt;Full Name&lt;/label&gt;
        &lt;input class=&quot;form-control&quot; id=&quot;name&quot; name=&quot;name&quot; type=&quot;text&quot; placeholder=&quot;Name&quot;
               value=&quot;{{ 'name' | formValue }}&quot; data-invalid=&quot;{{errorResponse('name')}}&quot;&gt;
        &lt;small id=&quot;name-help&quot; class=&quot;text-muted&quot;&gt;Your first and last name&lt;/small&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label class=&quot;form-label&quot; for=&quot;color&quot;&gt;Favorite color&lt;/label&gt;
        &lt;select id=&quot;color&quot; name=&quot;color&quot; class=&quot;col-4 form-control&quot; data-invalid=&quot;{{ 'color' | errorResponse }}&quot;&gt;
            &lt;option value=&quot;&quot;&gt;&lt;/option&gt;
            {{#each contactColors}}
                &lt;option value=&quot;{{Key}}&quot; {{ {selected:formValue('color')==Key} | htmlAttrs }}&gt;{{Value}}&lt;/option&gt;
            {{/each}}
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label class=&quot;form-check-label&quot;&gt;Favorite Film Genres&lt;/label&gt;
        &lt;div class=&quot;form-check&quot; data-invalid=&quot;{{ 'filmGenres' | errorResponse }}&quot;&gt;
        {{ 'filmGenres' | formValues | assignTo: selectedGenres }}
        {{#each contactGenres}}
            &lt;div class=&quot;custom-control custom-checkbox&quot;&gt;
                &lt;input type=&quot;checkbox&quot; id=&quot;filmGenres-{{it}}&quot; name=&quot;filmGenres&quot; value=&quot;{{it}}&quot; class=&quot;form-check-input&quot;
                       {{ {checked:contains(selectedGenres, it)} | htmlAttrs }}&gt;
                &lt;label class=&quot;form-check-label&quot; for=&quot;filmGenres-{{it}}&quot;&gt;{{it}}&lt;/label&gt;
            &lt;/div&gt;
        {{/each}}
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;input class=&quot;form-control col-3&quot; name=&quot;age&quot; type=&quot;number&quot; min=&quot;13&quot; placeholder=&quot;Age&quot;
               value=&quot;{{ 'age' | formValue }}&quot; data-invalid=&quot;{{errorResponse('age')}}&quot;&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;div class=&quot;form-check&quot;&gt;
            &lt;input class=&quot; form-check-input&quot; id=&quot;agree&quot; name=&quot;agree&quot; type=&quot;checkbox&quot; value=&quot;true&quot;
                   data-invalid=&quot;{{ 'agree' | errorResponse }}&quot;&gt;
            &lt;label class=&quot;form-check-label&quot; for=&quot;agree&quot;&gt;Agree to terms and conditions&lt;/label&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;button class=&quot;btn btn-primary&quot; type=&quot;submit&quot;&gt;Add Contact&lt;/button&gt;
        &lt;a href=&quot;{{ continue }}&quot;&gt;reset&lt;/a&gt;
    &lt;/div&gt;
&lt;/form&gt;

&lt;table id=&quot;results&quot;&gt;&lt;/table&gt;

{{#capture appendTo scripts}}
&lt;script&gt;var CONTACTS = {{ sendToGateway('GetContacts') | map =&gt; it.Results | json }};&lt;/script&gt;
{{/capture}}

{{#raw appendTo scripts}}
&lt;script src=&quot;/server-ts/contacts/index.js&quot;&gt;&lt;/script&gt;
{{/raw}}

{{ htmlError }}
</code></pre>
<h4 id="index.ts">index.ts<a class="header-anchor" href="javascript:;" onclick="location.hash='#index.ts'" aria-label="Permalink"> </a></h4>
<pre><code class="language-ts">import {bindHandlers, bootstrap, JsonServiceClient} from &quot;@servicestack/client&quot;;
import {Contact, DeleteContact, GetContacts} from &quot;../../../dtos&quot;;

declare var CONTACTS:Contact[];

const client = new JsonServiceClient();

bootstrap(); //converts data-invalid attributes into Bootstrap v4 error messages.

bindHandlers({
    deleteContact: async function(id:number) {
        if (!confirm('Are you sure?'))
            return;

        await client.delete(new DeleteContact({ id }));
        const response = await client.get(new GetContacts());
        CONTACTS = response.results;
        render();
    }
});

const contactRow = (contact:Contact) =&gt;
    `&lt;tr style=&quot;background:${contact.color}&quot;&gt;
        &lt;td&gt;${contact.title} ${contact.name} (${contact.age})&lt;/td&gt;
        &lt;td&gt;&lt;a href=&quot;/server-ts/contacts/${contact.id}/edit&quot;&gt;edit&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;button class=&quot;btn btn-sm btn-primary&quot; data-click=&quot;deleteContact:${contact.id}&quot;&gt;delete&lt;/button&gt;&lt;/td&gt;
    &lt;/tr&gt;`;

function render() {
    let sb = &quot;&quot;;
    if (CONTACTS.length &gt; 0) {
        for (let i=0; i&lt;CONTACTS.length; i++) {
            sb += contactRow(CONTACTS[i])
        }
    } else {
        sb = &quot;&lt;tr&gt;&lt;td&gt;There are no contacts.&lt;/td&gt;&lt;/tr&gt;&quot;;
    }
    document.querySelector(&quot;#results&quot;)!.innerHTML = `&lt;tbody&gt;${sb}&lt;/tbody&gt;`;
}

render();
</code></pre>
