

<h4 id="requires-auth-partial.html">_requires-auth-partial.html<a class="header-anchor" href="javascript:;" onclick="location.hash='#requires-auth-partial.html'" aria-label="Permalink"> </a></h4>
<pre><code class="language-html">{{ `/client-ts/login?continue=${PathInfo}`
   | redirectIfNotAuthenticated }}

&lt;div style=&quot;text-align:right&quot;&gt;
    &lt;small class=&quot;text-muted&quot;&gt;
        {{ userSession.DisplayName }}
        | &lt;a href=&quot;/auth/logout?continue=/client-ts/&quot;&gt;Sign Out&lt;/a&gt;
    &lt;/small&gt;
&lt;/div&gt;
</code></pre>
<h4 id="index.html">index.html<a class="header-anchor" href="javascript:;" onclick="location.hash='#index.html'" aria-label="Permalink"> </a></h4>
<pre><code class="language-html">{{ 'requires-auth' | partial }}

&lt;h3&gt;Add new Contact&lt;/h3&gt;

&lt;form action=&quot;/contacts&quot; method=&quot;post&quot; class=&quot;col-lg-4&quot;&gt;
    &lt;div class=&quot;form-group&quot; data-validation-summary=&quot;title,name,color,filmGenres,age,agree&quot;&gt;&lt;/div&gt;

    &lt;div class=&quot;form-group&quot;&gt;
        &lt;div class=&quot;form-check&quot;&gt;
            {{#each contactTitles}}
            &lt;div class=&quot;custom-control custom-radio custom-control-inline&quot;&gt;
                &lt;input type=&quot;radio&quot; id=&quot;title-{{Key}}&quot; name=&quot;title&quot; value=&quot;{{Key}}&quot; class=&quot;custom-control-input&quot;&gt;
                &lt;label class=&quot;custom-control-label&quot; for=&quot;title-{{Key}}&quot;&gt;{{Value}}&lt;/label&gt;
            &lt;/div&gt;
            {{/each}}
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;name&quot;&gt;Full Name&lt;/label&gt;
        &lt;input class=&quot;form-control&quot; id=&quot;name&quot; name=&quot;name&quot; type=&quot;text&quot; placeholder=&quot;Name&quot;&gt;
        &lt;small id=&quot;name-help&quot; class=&quot;text-muted&quot;&gt;Your first and last name&lt;/small&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label class=&quot;form-label&quot; for=&quot;color&quot;&gt;Favorite color&lt;/label&gt;
        &lt;select id=&quot;color&quot; name=&quot;color&quot; class=&quot;col-4 form-control&quot;&gt;
            &lt;option value=&quot;&quot;&gt;&lt;/option&gt;
            {{#each contactColors}}
                &lt;option value=&quot;{{Key}}&quot;&gt;{{Value}}&lt;/option&gt;
            {{/each}}
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label class=&quot;form-check-label&quot;&gt;Favorite Film Genres&lt;/label&gt;
        &lt;div class=&quot;form-check&quot;&gt;
        {{#each contactGenres}}
            &lt;div class=&quot;custom-control custom-checkbox&quot;&gt;
                &lt;input type=&quot;checkbox&quot; id=&quot;filmGenres-{{it}}&quot; name=&quot;filmGenres&quot; value=&quot;{{it}}&quot; class=&quot;form-check-input&quot;&gt;
                &lt;label class=&quot;form-check-label&quot; for=&quot;filmGenres-{{it}}&quot;&gt;{{it}}&lt;/label&gt;
            &lt;/div&gt;
        {{/each}}
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;input class=&quot;form-control col-3&quot; name=&quot;age&quot; type=&quot;number&quot; min=&quot;13&quot; placeholder=&quot;Age&quot;&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;div class=&quot;form-check&quot;&gt;
            &lt;input class=&quot; form-check-input&quot; id=&quot;agree&quot; name=&quot;agree&quot; type=&quot;checkbox&quot; value=&quot;true&quot;&gt;
            &lt;label class=&quot;form-check-label&quot; for=&quot;agree&quot;&gt;Agree to terms and conditions&lt;/label&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;button class=&quot;btn btn-primary&quot; type=&quot;submit&quot;&gt;Add Contact&lt;/button&gt;
        &lt;a href=&quot;/client-ts/contacts/&quot;&gt;reset&lt;/a&gt;
    &lt;/div&gt;
&lt;/form&gt;

&lt;table id=&quot;results&quot;&gt;&lt;/table&gt;

{{#capture appendTo scripts}}
&lt;script&gt;var CONTACTS = {{ sendToGateway('GetContacts') | map =&gt; it.Results | json }};&lt;/script&gt;
{{/capture}}

{{#raw appendTo scripts}}
&lt;script src=&quot;index.js&quot;&gt;&lt;/script&gt;
{{/raw}}

{{ htmlError }}
</code></pre>
<h4 id="index.ts">index.ts<a class="header-anchor" href="javascript:;" onclick="location.hash='#index.ts'" aria-label="Permalink"> </a></h4>
<pre><code class="language-ts">import { bootstrapForm, bindHandlers, JsonServiceClient } from &quot;@servicestack/client&quot;;
import {Contact, DeleteContact, GetContact, GetContacts} from &quot;../../../dtos&quot;;

declare var CONTACTS:Contact[];

const client = new JsonServiceClient();

const form = document.querySelector(&quot;form&quot;)!;
bootstrapForm(form,{
    success: function (r:{result:Contact}) {
        form.reset();
        CONTACTS.push(r.result);
        render();
    }
});
bindHandlers({
    deleteContact: async function(id:number) {
        if (!confirm('Are you sure?'))
            return;

        await client.delete(new DeleteContact({ id }));
        const response = await client.get(new GetContacts());
        CONTACTS = response.results;
        render();
    }
});

const contactRow = (contact:Contact) =&gt;
    `&lt;tr style=&quot;background:${contact.color}&quot;&gt;
        &lt;td&gt;${contact.title} ${contact.name} (${contact.age})&lt;/td&gt;
        &lt;td&gt;&lt;a href=&quot;/client-ts/contacts/${contact.id}/edit&quot;&gt;edit&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;button class=&quot;btn btn-sm btn-primary&quot; data-click=&quot;deleteContact:${contact.id}&quot;&gt;delete&lt;/button&gt;&lt;/td&gt;
    &lt;/tr&gt;`;

function render() {
    let sb = &quot;&quot;;
    if (CONTACTS.length &gt; 0) {
        for (let i=0; i&lt;CONTACTS.length; i++) {
            sb += contactRow(CONTACTS[i])
        }
    } else {
        sb = &quot;&lt;tr&gt;&lt;td&gt;There are no contacts.&lt;/td&gt;&lt;/tr&gt;&quot;;
    }
    document.querySelector(&quot;#results&quot;)!.innerHTML = `&lt;tbody&gt;${sb}&lt;/tbody&gt;`;
}

render();
</code></pre>
